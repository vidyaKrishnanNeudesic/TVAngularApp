<div class="episodes-container">
  <div class="episodes-header">
    <button mat-stroked-button color="primary" class="back-btn" (click)="goShowDetails()">
      &#8592; Back to Details
    </button>
  </div>
  <h2>Episodes for {{ showName() }}</h2>
  @if (groupedSeasons.length > 0) {
    <mat-accordion>
      @for (season of groupedSeasons; track season) {
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Season {{ season }} </mat-panel-title>
          </mat-expansion-panel-header>
          <div class="season-episodes">
            @for (ep of groupedEpisodes()[season]; track ep.id) {
              <div class="episode-card">
                @if (ep.image?.medium) {
                  <img class="episode-img" [src]="ep.image.medium" [alt]="ep.name" />
                }
                <div class="episode-header">
                  <strong>{{ ep.number }}. {{ ep.name }}</strong>
                  <span class="airdate">{{ ep.airdate }}</span>
                </div>
                <div
                  class="episode-summary"
                  [innerHTML]="ep.summary || 'No summary available.'"
                ></div>
                <button mat-stroked-button color="accent" (click)="watchTrailer(ep)">
                  Watch Trailer
                </button>
              </div>
            }
          </div>
        </mat-expansion-panel>
      }
    </mat-accordion>
  } @else {
    <div>No episodes available.</div>
  }
</div>
